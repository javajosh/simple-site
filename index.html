<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Function Idea</title>
	<script src="node_modules/jquery/dist/jquery.js"></script>
	<script src="node_modules/markdown/lib/markdown.js"></script>
</head>
<body>
	<h1>Function Idea</h1>
	<p>Treat the URL as a function invocation. Do it in two steps: first, define a higher-order function that takes an object and invokes another function based on it's properties. E.g. ?f=foobar would yield {f:'foobar'} would invoke <i>foobar()</i>. This nicely generalizes to arguments, e.g. f=foobar&amp;a=1&amp;a=2 would yield {f:'foobar', a:1, b:2} would be <i>foobar(1,2)</i> (or perhaps better <i>foobar({a:1, b:2})</i> since we can't really do ordering.)</p>

	<p>This is not just any function, of course, it's a top-level function in the application. It's something a developer might type at the command line. In general it might talk to the network, and it might affect the screen - probably both. In that sense the function should be considered a kind of <i>navigation function</i> in that these parameters are for reading only. (It generalizes to write preparation, but not to writing itself. Hopefully we'll get to that later!)</p>

	<p>First things first, some simple test code. What are we talking about?</p>
	<script>

		function foobar(o){
			console.log('foobar()', o);
		}

	</script>
	<p>Okay we've defined a new function, <i>foobar()</i>, that takes no arguments and just prints out it's own name to the console. Let's start by invoking it with an object.</p>
	<script>
		function assert(p, msg){if (!p) throw 'assertion failed: ' + msg;}
		function invoke(o){
			assert(typeof o === 'object', 'invoke only takes objects');
			assert(typeof o.f === 'string', 'invoke object requires a string f parameter');
			assert(typeof window[o.f] === 'function', 'function not found ' + o.f);
			var f = window[o.f];
			f(o);
		}
	</script>
	<div onclick="eval(arguments[0].target.innerHTML)">
		<button>invoke()</button>
		<button>invoke({})</button>
		<button>invoke({f:'nonsense'})</button>
		<button>invoke({f:'foobar'})</button>
	</div>
	<p>Okay, that worked great. Now let's try converting a string to an object like this one. We're probably better off using a library for this, like deparam.</p>
</body>
</html>